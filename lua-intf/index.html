<!DOCTYPE html>
 <html lang="en"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="preload" href="/page-component---src-pages-lua-intf-js-07e5d19770deccba29fd.js" as="script"/><link rel="preload" href="/path---lua-intf-586c7e095e534a3909ec.js" as="script"/><link rel="preload" href="/layout-component---index-a2879b35e1f569f89061.js" as="script"/><link rel="preload" href="/app-ea5dbf65ee48b2594b2e.js" as="script"/><link rel="preload" href="/commons-7d7dc5e746ede27497b7.js" as="script"/><script id="webpack-manifest">
            //<![CDATA[
            window.webpackManifest = {"15178676390636814000":"app-ea5dbf65ee48b2594b2e.js","8144742166368117000":"page-component---src-pages-404-js-d1b6fe165865514a0916.js","16228548823048030000":"page-component---src-pages-about-js-5419118fa496c621aa18.js","12200721278437278000":"page-component---src-pages-chaiscript-recipes-js-fa3a085a8ea66d302c98.js","9594620781867358000":"page-component---src-pages-artwork-js-c8e280078fd6c2791950.js","13387013374800785000":"page-component---src-pages-cubicroll-js-22976c655df1d72709b4.js","8405022255812999000":"page-component---src-pages-clion-multiple-binaries-js-80044aed22401d6f23c6.js","14571134556174995000":"page-component---src-pages-freeglut-fixed-window-js-96ff9306aaf5101346a5.js","4016850265702045000":"page-component---src-pages-index-js-44f1592a9debc885353d.js","12830661747251483000":"page-component---src-pages-hwcursor-js-441b1905ed8062eb534d.js","13689988232354690000":"page-component---src-pages-line-bound-js-9f7ca68d2345cc1d6624.js","118364875583439550":"page-component---src-pages-lua-intf-js-07e5d19770deccba29fd.js","17985156244173736000":"page-component---src-pages-nether-devlog-js-4a7d4dfdf0943de86e1d.js","14152405270936720000":"page-component---src-pages-nsf-devlog-2-js-f5951f8a90a5a652f8e0.js","9169554604063220000":"page-component---src-pages-nsf-devlog-js-4de1e5a183cb5922516f.js","1452333863259707600":"page-component---src-pages-nsf-js-b6084f66bc163fadbb4a.js","8002428301075783000":"page-component---src-pages-odd-cpp-js-0363c2151dc78f5033e0.js","8423724801861283000":"page-component---src-pages-portfolio-js-11e962bea5d2f4224912.js","9721245201524513000":"page-component---src-pages-projects-js-f3fbba3e832022518a23.js","12340945852327236000":"page-component---src-pages-sortvis-js-6b1b2f8790cb2126f85c.js","18059632766440628000":"page-component---src-pages-rebus-js-1f48aed18c2a8a760969.js","5866629043876192000":"page-component---src-pages-uncopy-js-9b0854540b537a69413c.js","3059561710810546700":"page-component---src-pages-unity-3-d-array-of-custom-objects-js-20f06d86d36ac00033da.js","7013240841797279000":"page-component---src-pages-unity-3-d-spectator-camera-js-4eb43a66d856daf1319c.js","1570422109460401700":"page-component---src-pages-unity-3-d-pick-and-drag-js-f2761a7eea84bf83e88e.js","16490050847094010000":"page-component---src-pages-unreal-platforms-js-1b5dc70e4e6e2b5ca564.js","882884807161904000":"page-component---src-pages-windows-main-js-52193057b9ac89b0e032.js","6926990323429763000":"page-component---src-pages-wireframe-js-bb7f2de64d78b05285db.js","16647598582412890000":"path---404-586c7e095e534a3909ec.js","17953591736895156000":"path---about-586c7e095e534a3909ec.js","7271501769925354000":"path---chaiscript-recipes-586c7e095e534a3909ec.js","9986001659661870000":"path---artwork-586c7e095e534a3909ec.js","12033017992842664000":"path---cubicroll-586c7e095e534a3909ec.js","12625989487647412000":"path---clion-multiple-binaries-586c7e095e534a3909ec.js","13487468619723299000":"path---freeglut-fixed-window-586c7e095e534a3909ec.js","9347362237655822000":"path---index-586c7e095e534a3909ec.js","1374190494701750000":"path---hwcursor-586c7e095e534a3909ec.js","10057997867254098000":"path---line-bound-586c7e095e534a3909ec.js","566472300682297700":"path---lua-intf-586c7e095e534a3909ec.js","11986119922783824000":"path---nether-devlog-586c7e095e534a3909ec.js","6198458038639085000":"path---nsf-devlog-2-586c7e095e534a3909ec.js","14687764190454106000":"path---nsf-devlog-586c7e095e534a3909ec.js","1816814809712808700":"path---nsf-586c7e095e534a3909ec.js","8736120395001223000":"path---odd-cpp-586c7e095e534a3909ec.js","12589110883905569000":"path---portfolio-586c7e095e534a3909ec.js","6408524664133516000":"path---projects-586c7e095e534a3909ec.js","10770882656350593000":"path---sortvis-586c7e095e534a3909ec.js","4702101129390883000":"path---rebus-586c7e095e534a3909ec.js","9838961998885528000":"path---uncopy-586c7e095e534a3909ec.js","11619470239911205000":"path---unity-3-d-array-of-custom-objects-586c7e095e534a3909ec.js","14812566356430060000":"path---unity-3-d-spectator-camera-586c7e095e534a3909ec.js","15848427140066738000":"path---unity-3-d-pick-and-drag-586c7e095e534a3909ec.js","12210310786293494000":"path---unreal-platforms-586c7e095e534a3909ec.js","6076917203444821000":"path---windows-main-586c7e095e534a3909ec.js","12009341268478530000":"path---wireframe-586c7e095e534a3909ec.js","11711201792954765000":"path---404-html-586c7e095e534a3909ec.js","17241999800008180000":"layout-component---index-a2879b35e1f569f89061.js"}
            //]]>
            </script><style type="text/css" id="server-side-jss">.root-0-7 {
  margin-bottom: 40px;
}
.root-0-7 h1 {
  font-size: 2em;
  line-height: 1.5em;
}
.underline-0-8 {
  width: 100%;
  height: 1px;
  border-bottom: 1px solid #eee;
}
.date-0-9 {
  color: #b1b1b1;
  font-size: 0.9em;
  margin-bottom: 0px;
}
.root-0-10 {
  margin-bottom: 20px;
}
.root-0-4 {
  color: #0090B2;
  text-decoration: none;
}
.root-0-4:visited {
  text-decoration: none;
}
.root-0-4:focus {
  color: #0018BB;
  text-decoration: none;
}
.root-0-4:hover {
  color: #0018BB;
  text-decoration: none;
}
.disguise-0-5 {
  color: #34495e;
}
.disguise-0-5:hover {
  color: #34495e;
}
.disguise-0-5:visited {
  color: #34495e;
}
.disguise-0-5:focus {
  color: #34495e;
}
.root-0-11 {
  margin-bottom: 30px;
}
.root-0-12 {
  margin-top: 50px;
}
.root-0-0 {
  width: 900px;
  margin: 0 auto;
  height: 80px;
  display: flex;
  max-width: 900px;
  align-items: center;
  flex-direction: row;
  justify-content: space-between;
}
.brand-0-1 {
  display: flex;
  align-items: center;
}
.brand-0-1 div {
  display: inline-block;
}
.logo-0-2 {
  width: 50px;
  height: 25px;
  margin-right: 20px;
  background-size: cover;
  background-image: url(data:image/png;base64,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);
  background-position: 0;
}
.menu-0-3 {
  display: flex;
  flex-direction: row;
  justify-content: space-between;
}
.menu-0-3 a {
  margin-right: 20px;
}
.menu-0-3 a:last-child {
  margin-right: 0;
}
.root-0-6 {
  width: 900px;
  margin: 30px auto 0 auto;
  max-width: 900px;
}
.root-0-13 {
  width: 100%;
  bottom: 0;
  height: 100px;
  display: flex;
  position: absolute;
  align-items: center;
}
.content-0-14 {
  width: 900px;
  margin: 0 auto;
  max-width: 900px;
}</style><title data-react-helmet="true">C++ embedded scripting: LuaIntf recipes | Aleksey Fedotov</title><script>
  !function(e,t,r){function n(){for(;d[0]&&"loaded"==d[0][f];)c=d.shift(),c[o]=!i.parentNode.insertBefore(c,i)}for(var s,a,c,d=[],i=e.scripts[0],o="onreadystatechange",f="readyState";s=r.shift();)a=e.createElement(t),"async"in i?(a.async=!1,e.head.appendChild(a)):i[f]?(d.push(a),a[o]=n):e.write("<"+t+' src="'+s+'" defer></'+t+">"),a.src=s}(document,"script",[
  "/commons-7d7dc5e746ede27497b7.js","/app-ea5dbf65ee48b2594b2e.js","/layout-component---index-a2879b35e1f569f89061.js","/path---lua-intf-586c7e095e534a3909ec.js","/page-component---src-pages-lua-intf-js-07e5d19770deccba29fd.js"
])
  </script><link rel="shortcut icon" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAAATlJREFUWIXtlb9KA0EQhz8l4isIgSAH2ttY2UXEJ/ARRC20ibUg6U1ULOx8gVhG8AkUrEQ9BB9AUpuYU6PF7sKoO+T2jJBiP1g45rc3v5nbPweRSCQypiRAE0iBLvBZcGTAI3AMzOc137EvFjXVxhuwm8d8VIYDJV7TzBOl82VgJdC8BUwD2x4tQ1mOhpLMEVLAvn1nSdGPfAU8jKCANnBpuzwHnjEb+ezH1019BbyICXXfBMuaYn5n9QngScTnbPxQxPouWUkkls9FKAMLwBQwI+KrmKO8KGIDX4J7fnf1LvSQPXBlDU8U/dYlnRQG7dy9DqcFXAOnin7hC84CPb5X+gFUCT+GHWAPuPFoXaCiVb4ZaFRkrGvmji3g9R+Me8DGMHNHgrmYUv72X+hj7pcDzBJHIpHI+PEFo5MROikkzA0AAAAASUVORK5CYII="/><style id="gatsby-inlined-css">.hljs{display:block;overflow-x:auto;padding:.5em;color:#000;background:#f8f8ff}.hljs-comment,.hljs-quote{color:#408080;font-style:italic}.hljs-keyword,.hljs-literal,.hljs-selector-tag,.hljs-subst{color:#954121}.hljs-number{color:#40a070}.hljs-doctag,.hljs-string{color:#219161}.hljs-section,.hljs-selector-class,.hljs-selector-id,.hljs-type{color:#19469d}.hljs-params{color:#00f}.hljs-title{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-template-variable,.hljs-variable{color:teal}.hljs-link,.hljs-regexp{color:#b68}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@font-face{font-family:OpenSans;src:url(/static/OpenSans-Regular-webfont.83efe336.eot);src:url(/static/OpenSans-Regular-webfont.83efe336.eot?#iefix) format("embedded-opentype"),url(/static/OpenSans-Regular-webfont.55b8ce1f.woff) format("woff"),url(/static/OpenSans-Regular-webfont.3cbf4d3e.ttf) format("truetype"),url(/static/OpenSans-Regular-webfont.2d13ddbb.svg#open_sansregular) format("svg");font-weight:400;font-style:normal}body,html{margin:0;padding:0;font-family:OpenSans,sans-serif;font-size:18px;line-height:31px;color:#34495e}html{position:relative;min-height:100%}body{margin-bottom:150px}h1,h2,h3,h4{margin-top:0;margin-bottom:0}iframe{border:none}</style></head><body><div id="___gatsby"><div data-reactroot="" data-reactid="1" data-react-checksum="1168345550"><div class="root-0-0" data-reactid="2"><a class="root-0-4 disguise-0-5" href="/" target="" data-reactid="3"><div class="brand-0-1" data-reactid="4"><div class="logo-0-2" data-reactid="5"></div><div data-reactid="6">// Home page of one programmer</div></div></a><div class="menu-0-3" data-reactid="7"><a class="root-0-4 " href="/" target="" data-reactid="8"><strong data-reactid="9">Articles</strong></a><a class="root-0-4 " href="/projects" target="" data-reactid="10"><strong data-reactid="11">Projects</strong></a><a class="root-0-4 " href="/about" target="" data-reactid="12"><strong data-reactid="13">About</strong></a></div></div><div class="root-0-6" data-reactid="14"><div data-reactid="15"><div class="root-0-7" data-reactid="16"><h1 data-reactid="17">C++ embedded scripting: LuaIntf recipes</h1><div class="underline-0-8" data-reactid="18"></div><span class="date-0-9" data-reactid="19">30 Sep 2015</span><!-- react-empty: 20 --></div><div class="root-0-10" data-reactid="21"><!-- react-text: 22 -->In my <!-- /react-text --><a class="root-0-4 " href="/chaiscript-recipes" target="" data-reactid="23">previous post</a><!-- react-text: 24 --> on C++ embedded scripting I talked about ChaiScript and described how to implement some tricky cases when embedding this language into your C++ application. Although the language is really interesting, there are some flaws in it that I find serious, like, for example, not very rich syntax or long compilation times.<!-- /react-text --></div><div class="root-0-10" data-reactid="25"><!-- react-text: 26 -->Having said that, I decided to search again in attempt to find a good Lua binding library. After some research I found one - <!-- /react-text --><a class="root-0-4 " href="https://github.com/SteveKChiu/lua-intf" target="" data-reactid="27">LuaInft</a><!-- react-text: 28 --> (C++11), which I want to talk about today. A good documentation (at least it has one!) plus the fact that its author positions the library as a modern remake of LuaBridge (another good, but abandoned library), attracted my attention immediately.<!-- /react-text --></div><div class="root-0-10" data-reactid="29">As with many libraries, at some point you’ll come across a task that you won’t find in the documentation. The major flaw of LuaInft is the lack of tests or samples that could shed more light on the examples of library usage, aside from rather “generic” docs. This article is aimed at saving your time and fixing this particular problem. I’ll illustrate the results of my experiments with this library in a form of code examples - the way that I find most convenient for learning libraries and discovering their possibilities. Be warned: consult documentation a lot if you don’t know the very basics yet. These snippets won’t cover things that are in the docs already.</div><div class="root-0-10" data-reactid="30"><!-- react-text: 31 -->Lets start with the bare minimum - the <!-- /react-text --><strong data-reactid="32">simplest, ready-to-use program running LuaIntf</strong><!-- react-text: 33 -->. Unfortunately the documentation doesn’t seem to have it in one piece:<!-- /react-text --></div><div class="root-0-11" data-reactid="34"><pre data-reactid="35"><code class="c++" data-reactid="36">#include &lt;LuaIntf.h&gt;

namespace LuaIntf
{
    // Enable support for shared_ptr, vector and map.
    // This will allow us to use shared_ptr almost interchangeably with raw pointers,
    // as well as use Lua tables to handle C++ vectors and maps
    LUA_USING_SHARED_PTR_TYPE(std::shared_ptr)
    LUA_USING_LIST_TYPE(std::vector)
    LUA_USING_MAP_TYPE(std::map)
}

int main()
{
    using namespace LuaIntf;
    LuaState lua;
    lua.openLibs();
    lua.doString(&quot;lua code here&quot;);
    return 0;
}</code></pre></div><div class="root-0-10" data-reactid="37">(btw, setting header search paths and linking to the library is outside the scope of this article).</div><div class="root-0-10" data-reactid="38"><!-- react-text: 39 -->Let’s <!-- /react-text --><strong data-reactid="40">bind some enums</strong><!-- react-text: 41 -->. Unfortunately if you Ctrl+F “enum” in the docs, you’ll find no mentions. I can think of two ways:<!-- /react-text --></div><div class="root-0-11" data-reactid="42"><pre data-reactid="43"><code class="c++" data-reactid="44">enum class TestEnum // should be no different from classic enums
{
    Value
};

LuaBinding(lua).beginModule(&quot;test&quot;)
    .addConstant(&quot;TestEnum_Value&quot;, TestEnum::Value)
.endModule();

// or

LuaBinding(lua).beginModule(&quot;test&quot;)
    .beginModule(&quot;TestEnum&quot;)
        .addConstant(&quot;Value&quot;, TestEnum::Value)
    .endModule()
.endModule();

// Lua
print(test.TestEnum_Value)
-- or
print(test.TestEnum.Value)</code></pre></div><div class="root-0-10" data-reactid="45">The second way is probably better, because it’d allow you to easily enumerate all enum values in Lua. If it’s ever needed.</div><div class="root-0-10" data-reactid="46"><!-- react-text: 47 -->Working with <!-- /react-text --><strong data-reactid="48">inheritance and smart pointers</strong><!-- react-text: 49 -->:<!-- /react-text --></div><div class="root-0-11" data-reactid="50"><pre data-reactid="51"><code class="c++" data-reactid="52">class Base
{
public:
    virtual ~Base() {}
    virtual std::string first() = 0;
    virtual int second() const { return 123; }
};

class A : public Base
{
public:
    virtual std::string first() override { return &quot;Hello, world&quot;; }
    virtual int second() const override { return 2; }
    virtual int third() const { return 3; }
    int fourth() const { return 4; }
};

std::shared_ptr&lt;Base&gt; make()
{
    return std::make_shared&lt;A&gt;();
}

// ...

LuaBinding(lua).beginModule(&quot;test&quot;)
    .beginClass&lt;Base&gt;(&quot;Base&quot;)
        .addFunction(&quot;first&quot;, &amp;Base::first)
        .addFunction(&quot;second&quot;, &amp;Base::second)
    .endClass()
    .beginExtendClass&lt;A, Base&gt;(&quot;A&quot;)
        .addFunction(&quot;third&quot;, &amp;A::third)
        .addFunction(&quot;fourth&quot;, &amp;A::fourth)
    .endClass()
    .addFunction(&quot;make&quot;, &amp;make)
.endModule();

// Lua
local a = test.make()
print(a:first())
print(a:second())
print(a:third())
print(a:fourth())

// Output
Hello, world
2
3
4</code></pre></div><div class="root-0-10" data-reactid="53">So basically if you have a pointer to an object Lua will figure out what methods are available on it and perform downcast if needed.</div><div class="root-0-10" data-reactid="54"><strong data-reactid="55">Passing Lua objects to C++ code:</strong></div><div class="root-0-11" data-reactid="56"><pre data-reactid="57"><code class="c++" data-reactid="58">std::string acceptStuff(LuaRef luaObj,
    const std::vector&lt;std::string&gt;&amp; stringVector,
    std::map&lt;std::string, int&gt;&amp; dict)
{
    // Assume that this function expects Lua object (table) as first argument
    auto func = luaObj.get&lt;std::function&lt;std::string(int)&gt;&gt;(&quot;func&quot;);
    auto stringField = luaObj.get&lt;std::string&gt;(&quot;str&quot;);
    std::ostringstream s;
    s &lt;&lt; &quot;func() result: &quot; &lt;&lt; func(10) &lt;&lt; &quot;, string field value: &quot;
      &lt;&lt; stringField &lt;&lt; &quot;\n&quot;;
    s &lt;&lt; &quot;Vector size: &quot; &lt;&lt; stringVector.size() &lt;&lt; &quot;, first element: &quot;
      &lt;&lt; stringVector[0] &lt;&lt; &quot;\n&quot;;
    s &lt;&lt; &quot;Dictionary size: &quot; &lt;&lt; dict.size() &lt;&lt; &quot;, first element: (&quot; &lt;&lt;
        dict.begin()-&gt;first &lt;&lt; &quot;, &quot; &lt;&lt; dict.begin()-&gt;second &lt;&lt; &quot;)&quot;;
    return s.str();
}

LuaBinding(lua).beginModule(&quot;test&quot;)
    .addFunction(&quot;acceptStuff&quot;, &amp;acceptStuff)
.endModule();

// Lua
local obj = {
    func = function(i)
        return &quot;You passed number &quot; .. i
    end,
    str = &quot;Hello, world&quot;
}
local v = { 1, 2, 3 }
local dict = { first = 1, second = 2 }
print(test.acceptStuff(obj, v, dict))

// Output
func() result: You passed number 10, string field value: Hello, world
Vector size: 3, first element: 1
Dictionary size: 2, first element: (first, 1)</code></pre></div><div class="root-0-10" data-reactid="59"><!-- react-text: 60 -->Now to the interesting part: <!-- /react-text --><strong data-reactid="61">attaching C++ functions to C++ objects for using inside Lua</strong><!-- react-text: 62 -->. Let’s say you want to bind a C++ class to Lua, but at some point you realize you need a few more methods in the class for use inside scripts only. An easy way would be to include those methods directly into the class or into some “mixin” class that you would later inherit from. This is not a very good solution, at least if you’re aiming at keeping code clean, separating concerns, maintainability and flexibility. Luckily LuaIntf allows us to attach arbitrary C++ methods to a class. For instance:<!-- /react-text --></div><div class="root-0-11" data-reactid="63"><pre data-reactid="64"><code class="c++" data-reactid="65">class Base
{
public:
    virtual ~Base() {}

    virtual int one() const
    {
        return 123;
    }
};

class A : public Base
{
public:
    virtual int one() const override
    {
        return 2;
    }

    int two() const
    {
        return 4;
    }
};

std::shared_ptr&lt;Base&gt; makeAsBase()
{
    return std::make_shared&lt;A&gt;();
}

std::shared_ptr&lt;A&gt; makeAsA()
{
    return std::make_shared&lt;A&gt;();
}

int externalBaseFunc(Base* obj)
{
    return obj-&gt;one();
}

int externalAFunc(A* obj)
{
    return obj-&gt;two();
}

LuaBinding(lua).beginModule(&quot;test&quot;)
    .beginClass&lt;Base&gt;(&quot;Base&quot;)
        .addFunction(&quot;externalBaseFunc&quot;, &amp;externalBaseFunc)
    .endClass()
    .beginExtendClass&lt;A, Base&gt;(&quot;A&quot;)
        .addFunction(&quot;externalAFunc&quot;, &amp;externalAFunc)
    .endClass()
    .addFunction(&quot;makeAsBase&quot;, &amp;makeAsBase)
    .addFunction(&quot;makeAsA&quot;, &amp;makeAsA)
.endModule();

lua.doString(R&quot;s(
    local a = test.makeAsBase()
    print(a:externalBaseFunc())
    print(a:externalAFunc())

    local b = test.makeAsA()
    print(b:externalBaseFunc())
    print(b:externalAFunc())
)s&quot;);

// Output:
2
4
2
4</code></pre></div><div class="root-0-10" data-reactid="66"><!-- react-text: 67 -->Liked it? Then go to the <!-- /react-text --><a class="root-0-4 " href="https://github.com/SteveKChiu/lua-intf" target="" data-reactid="68">library Github</a><!-- react-text: 69 --> page and show it some support. Overall I think LuaIntf is a great choice in terms of feature set, but the only bad thing about this library is the lack of tests. Really, how does the author know it works?<!-- /react-text --></div><div class="root-0-12" data-reactid="70"><div data-reactid="71"><div id="disqus_thread" data-reactid="72"></div></div></div></div></div><div class="root-0-13" data-reactid="73"><div class="content-0-14" data-reactid="74">© 2014-2017 Aleksey Fedotov</div></div></div></div></body></html>