<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<title>Статическая линковка Visual Studio Runtime | Raycast</title>

		<link href="/css/vendor/bootstrap.min.css" rel="stylesheet">
    	<link href="/css/flat-ui.min.css" rel="stylesheet">
		<link rel="stylesheet" href="/css/style.css"/>
		<link rel="stylesheet" href="/css/syntax.css" media="screen"/>
		<link rel="stylesheet" href="/css/fancybox/jquery.fancybox.css" media="screen"/>
		<link rel="stylesheet" href="/css/fancybox/jquery.fancybox-buttons.css" media="screen" />
		<link rel="stylesheet" href="/css/fancybox/jquery.fancybox-thumbs.css" media="screen" />
		<link rel="shortcut icon" type="image/png" href="/data/gamepad2.png">

	</head>
	<body>
		<div class="container page">
			<div class="navbar navbar-default" role="navigation">
	<div class="container-fluid">
		<div class="navbar-header">
			<a class="navbar-brand" href="/">
				<img src="/data/gamepad_large.png"/>
			</a>
			<div class="navbar-text">Home page of one programmer</div>
		</div>
		<ul class="nav navbar-nav navbar-right">
			<li ><a href="/">Blog</a></li>
			<li ><a href="/portfolio/">Portfolio</a></li>
			<li ><a href="/about/">About</a></li>
		</ul>
	</div>
</div>


			<div class="content">
				<div class="article">
	<div class="row">
		<div class="col-xs-12">
			<h2>Статическая линковка Visual Studio Runtime</h2>
			
				<span class="small text-muted">06 Feb 2011</span>
			
		</div>
	</div>
	
	<div class="article-content">
		<p>Распространенная проблема у начинающих: собранный со стандартными настройками в Visual Studio проект
на С/С++ не запускается на другом компьютере. Причина кроется в том, что исполняемый файл цепляет
стандартные библиотеки языков С и С++, которые по умолчанию линкуются динамически. В состав Windows
эти библиотеки не входят, зато поставляются вместе со студией, либо устанавливаются отдельно пакетом
Visual Studio Redistributable соответствующей версии. Вы могли замечать, что инсталляторы некоторых программ
в процессе работы ставят такой пакет – как раз из-за библиотек.</p>

<!--break-->

<p>Есть несколько способов решить проблему:</p>

<ul>
<li>Заставлять пользователя устанавливать пакет. Утверждается, что установленные таким образом библиотеки обновляются
вместе с виндой, поэтому у пользователя всегда самая свежая версия с закрытыми дырами в безопасности, поправленными
старыми багами (и добавленными новыми). Как бы там ни твердили, что это круто, я так не считаю, по двум причинам.
Во-первых, надо заставлять пользователя устанавливать какую-то неведомую для него хрень. Т.к. все пишут в разных
версиях Visual Studio, то и библиотеки требуют от пользователя тоже разных версий. Со временем все это копится на
компьютере и начинает выглядеть как мусор:

<div class="row text-center"><img src="/data/redistr.png" class="margined20"/></div>

Во-вторых, если твоя программа протестирована с конкретной версией библиотеки, то это еще не значит, что новая версия
не добавит новых багов, и программа и дальше будет работать нормально. Всегда есть вероятность того, что после очередного
обновления библиотек программа просто сдохнет.
</li>

<li>Вместе с исполняемым файлом распространять файлы библиотек из папки `C:\Program Files\Microsoft Visual Studio 9.0\VC\redist\x86\Microsoft.VC90.CRT\`
(или аналогичных, соответствующих архитектуре и версии компилятора). Этот способ так часто используется, что для меня уже стало своего рода развлечением
заглядывать в папки с новыми программами и искать там те самые DLL-ки. Несколько примеров:

<div class="row text-center"><img src="/data/example1.png" class="margined20"/></div>
<div class="row text-center"><img src="/data/example2.png" class="margined20"/></div>
<div class="row text-center"><img src="/data/example3.png" class="margined20"/></div>
<div class="row text-center"><img src="/data/example4.png" class="margined20"/></div>
<div class="row text-center"><img src="/data/example5.png" class="margined20"/></div>

</li>

<li>
Линковать библиотеки статически. Отличный способ для любитей минимализма (я в их числе). В настройках проекта в пункте
`Project -> Properties -> Configuration Properties -> C/C++ -> Code Generation -> Runtime Library` указать опцию,
не содержащую “DLL” (в зависимости от Debug или Release версии). Можно убедиться, что библиотеки не линкуются динамически,
запустив проект в студии и заглянув в окошко Modules. В консольном проекте в Visual Studio Express 2010 у меня там 3 библиотеки:
ntdll.dll, kernel32.dll и KernelBase.dll. Если оставить динамическую линковку, к ним добавляются msvcp100.dll (C++ рантайм) и msvcr100.dll (С рантайм).
</li>

</ul>

	</div>
</div>

			<div>

			
	<div id="disqus_thread">
	</div>
	<script type="text/javascript">
		var disqus_shortname = 'raycastnet'; // required: replace example with your forum shortname
		(function() {
			var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
			dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
			(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
		})();
	</script>
	<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
	<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


		</div>

		<div class="footer">
	<p class="text-muted">© 2014-2016 Aleksey Fedotov</p>
</div>

<script src="/js/vendor/jquery.min.js"></script>
<script src="/js/vendor/video.js"></script>
<script src="/js/flat-ui.min.js"></script>
<script src="/js/fancybox/jquery.fancybox.pack.js"></script>
<script src="/js/fancybox/jquery.fancybox-buttons.js"></script>
<script src="/js/fancybox/jquery.fancybox-media.js"></script>
<script src="/js/fancybox/jquery.fancybox-thumbs.js"></script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-50872849-1', 'raycast.net');
  ga('send', 'pageview', {
    "page": "/2011/02/06/msvs-static-linking.html",
    "title": 'Статическая линковка Visual Studio Runtime'
  });
</script>

<script>
	$(document).ready(function() {
		$(".lightbox").fancybox();
	});
</script>

	</body>
</html>
